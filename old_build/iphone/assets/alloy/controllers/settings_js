function Controller(){function e(e){var t=Ti.UI.createEmailDialog();t.subject="TheTollEasy debug data",t.toRecipients=["phakhruddin@gmail.com"],t.messageBody="Debug data on "+new Date;var i=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,"maildebug.txt"),o=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,e+".txt"),a=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,e+"1.txt"),l=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,"location.txt");t.addAttachment(i),t.addAttachment(o),t.addAttachment(a),t.addAttachment(l),t.open()}function t(e){for(var t=e.split("\n"),i=[],o=t[0].split(","),a=1;t.length>a;a++){for(var l={},n=t[a].split(","),r=0;o.length>r;r++)l[o[r]]=n[r];i.push(l)}return JSON.stringify(i)}require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="settings",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var i=this,o={};Alloy.Collections.instance("plazano"),i.__views.win_settings=Ti.UI.createWindow({backgroundColor:"black",barColor:"white",apiName:"Ti.UI.Window",id:"win_settings",title:"Settings",classes:["container"]});var a=[];i.__views.__alloyId53=Ti.UI.createTableViewSection({apiName:"Ti.UI.TableViewSection",headerTitle:"Background Loc Capture Options",id:"__alloyId53",classes:[]}),a.push(i.__views.__alloyId53),i.__views.row_contupd=Ti.UI.createTableViewRow({apiName:"Ti.UI.TableViewRow",id:"row_contupd",Title:"Continous Update",classes:[]}),i.__views.__alloyId53.add(i.__views.row_contupd),i.__views.label_contupd=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"white",text:"Detect TollPlaza ON/OFF",apiName:"Ti.UI.Label",id:"label_contupd",top:"5",left:"20",classes:[]}),i.__views.row_contupd.add(i.__views.label_contupd),i.__views.label_contupd1=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"gray",font:{fontFamily:"Helvetica",fontSize:"8dp",fontStyle:"normal",fontWeight:"normal"},text:"Turn ON/OFF background continous capture",apiName:"Ti.UI.Label",id:"label_contupd1",top:"30",left:"20",classes:[]}),i.__views.row_contupd.add(i.__views.label_contupd1),i.__views.switch_contupd=Ti.UI.createSwitch({value:!1,apiName:"Ti.UI.Switch",id:"switch_contupd",right:"20",titleOff:"OFF",titleOn:"ON",classes:[]}),i.__views.row_contupd.add(i.__views.switch_contupd),i.__views.row_contupdsimple=Ti.UI.createTableViewRow({apiName:"Ti.UI.TableViewRow",id:"row_contupdsimple",Title:"Continous Update",classes:[]}),i.__views.__alloyId53.add(i.__views.row_contupdsimple),i.__views.label_contupdsimple=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"white",text:"Capture Loc Only ON/OFF",apiName:"Ti.UI.Label",id:"label_contupdsimple",top:"5",left:"20",classes:[]}),i.__views.row_contupdsimple.add(i.__views.label_contupdsimple),i.__views.label_contupd1=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"gray",font:{fontFamily:"Helvetica",fontSize:"8dp",fontStyle:"normal",fontWeight:"normal"},text:"Capture date, lat/lot coordinates",apiName:"Ti.UI.Label",id:"label_contupd1",top:"30",left:"20",classes:[]}),i.__views.row_contupdsimple.add(i.__views.label_contupd1),i.__views.switch_contupdsimple=Ti.UI.createSwitch({value:!1,apiName:"Ti.UI.Switch",id:"switch_contupdsimple",right:"20",titleOff:"OFF",titleOn:"ON",classes:[]}),i.__views.row_contupdsimple.add(i.__views.switch_contupdsimple),i.__views.row_contupdcomplex=Ti.UI.createTableViewRow({apiName:"Ti.UI.TableViewRow",id:"row_contupdcomplex",Title:"Continous Update",classes:[]}),i.__views.__alloyId53.add(i.__views.row_contupdcomplex),i.__views.label_contupdcomplex=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"white",text:"Cap & Det Toll ON/OFF",apiName:"Ti.UI.Label",id:"label_contupdcomplex",top:"5",left:"20",classes:[]}),i.__views.row_contupdcomplex.add(i.__views.label_contupdcomplex),i.__views.label_contupd1=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"gray",font:{fontFamily:"Helvetica",fontSize:"8dp",fontStyle:"normal",fontWeight:"normal"},text:"Capture coordinates and detect tollplaza(s) hit",apiName:"Ti.UI.Label",id:"label_contupd1",top:"30",left:"20",classes:[]}),i.__views.row_contupdcomplex.add(i.__views.label_contupd1),i.__views.switch_contupdcomplex=Ti.UI.createSwitch({value:!1,apiName:"Ti.UI.Switch",id:"switch_contupdcomplex",right:"20",titleOff:"OFF",titleOn:"ON",classes:[]}),i.__views.row_contupdcomplex.add(i.__views.switch_contupdcomplex),i.__views.__alloyId54=Ti.UI.createTableViewSection({apiName:"Ti.UI.TableViewSection",headerTitle:"Utilities",id:"__alloyId54",classes:[]}),a.push(i.__views.__alloyId54),i.__views.row_debug=Ti.UI.createTableViewRow({apiName:"Ti.UI.TableViewRow",id:"row_debug",Title:"Debug",classes:[]}),i.__views.__alloyId54.add(i.__views.row_debug),i.__views.label_debug=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"white",text:"Debugging ON/OFF",apiName:"Ti.UI.Label",id:"label_debug",top:"5",left:"20",classes:[]}),i.__views.row_debug.add(i.__views.label_debug),i.__views.switch_debug=Ti.UI.createSwitch({value:!1,apiName:"Ti.UI.Switch",id:"switch_debug",right:"20",titleOff:"OFF",titleOn:"ON",classes:[]}),i.__views.row_debug.add(i.__views.switch_debug),i.__views.row_emaildebug=Ti.UI.createTableViewRow({apiName:"Ti.UI.TableViewRow",id:"row_emaildebug",Title:"Email Debug",classes:[]}),i.__views.__alloyId54.add(i.__views.row_emaildebug),i.__views.label_emaildebug=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"orange",text:"Email Debug Data",apiName:"Ti.UI.Label",id:"label_emaildebug",left:"20",classes:[]}),i.__views.row_emaildebug.add(i.__views.label_emaildebug),i.__views.row_skin=Ti.UI.createTableViewRow({apiName:"Ti.UI.TableViewRow",id:"row_skin",Title:"Skin",classes:[]}),i.__views.__alloyId54.add(i.__views.row_skin),i.__views.label_skinwhite=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"orange",text:"Switch Background to white",apiName:"Ti.UI.Label",id:"label_skinwhite",left:"20",classes:[]}),i.__views.row_skin.add(i.__views.label_skinwhite),i.__views.row_caplocdata=Ti.UI.createTableViewRow({apiName:"Ti.UI.TableViewRow",id:"row_caplocdata",Title:"CapLocData",classes:[]}),i.__views.__alloyId54.add(i.__views.row_caplocdata),i.__views.label_caplocdata=Ti.UI.createLabel({width:Ti.UI.SIZE,height:Ti.UI.SIZE,color:"white",text:"Captured Location Data",apiName:"Ti.UI.Label",id:"label_caplocdata",left:"20",classes:[]}),i.__views.row_caplocdata.add(i.__views.label_caplocdata),i.__views.table_settings=Ti.UI.createTableView({backgroundColor:"black",data:a,apiName:"Ti.UI.TableView",id:"table_settings",classes:[]}),i.__views.win_settings.add(i.__views.table_settings),i.__views.tab_settings=Ti.UI.createTab({window:i.__views.win_settings,apiName:"Ti.UI.Tab",id:"tab_settings",classes:[]}),i.__views.tab_settings&&i.addTopLevelView(i.__views.tab_settings),o.destroy=function(){},_.extend(i,i.__views),arguments[0]||{},o.openMainWindow=function(e){e.open(i.win_settings),console.debug("This is child widow settings.js"+e)},loc=Titanium.App.Properties.getString("loc")?Titanium.App.Properties.getString("loc"):"newberlin",i.switch_contupd.addEventListener("change",function(){var e=i.switch_contupd.value;if(Ti.API.info("background service is :"+e),1==e){alert("Detect TollPlaza is ON"),Ti.API.info("Registering background services");var t=Ti.App.iOS.registerBackgroundService({url:"bg-service1.js"});console.log("service after start is: "+JSON.stringify(t)),Ti.API.info("*** Press home button to pause application ***")}else{var t=Ti.App.iOS.registerBackgroundService({url:"bg-service1.js"});console.log("stopping service :"+JSON.stringify(t)),t.stop(),t.unregister(),alert("Detect TollPlaza is OFF")}}),i.switch_contupdsimple.addEventListener("change",function(){var e=i.switch_contupdsimple.value;Ti.API.info("simple tracking is :"+e),1==e?Titanium.App.Properties.setInt("simpletracking",1):Titanium.App.Properties.setInt("simpletracking",0)}),i.switch_contupdcomplex.addEventListener("change",function(){var e=i.switch_contupdcomplex.value;Ti.API.info("complex tracking is :"+e),1==e?Titanium.App.Properties.setInt("complextracking",1):Titanium.App.Properties.setInt("complextracking",0)}),i.switch_debug.addEventListener("change",function(){var e=i.switch_debug.value;Ti.API.info("debugging is :"+e),1==e?Titanium.App.Properties.setInt("maildebug","1"):Titanium.App.Properties.setInt("maildebug","0")}),i.label_skinwhite.addEventListener("click",function(){}),i.label_emaildebug.addEventListener("click",function(){e()}),i.label_caplocdata.addEventListener("click",function(){var e=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,"location.txt");if(e.exists()){var o=e.read(),a=t(o.text);console.log(a);for(var a=JSON.parse(a),l=0;+a.length>l;l++)if(Update=a[l].Date?1:0,console.log("Updating location DB with :"+a[l].Date+","+a[l].LAT+","+a[l].LON+","+a[l].Timestamp),1==Update){Alloy.Collections.plazano.deleteTollPlaza(a[l].Date);var n=Alloy.createModel("plazano",{tollplaza:a[l].Date,latitude:a[l].LAT,longitude:a[l].LON,altitude:"0",heading:"0",speed:"0",hwy:"0",accuracy:"0",timestamp:a[l].Timestamp,altitudeAccuracy:"0",cost:"0",source:"0",location:"none",note:"none"});n.save()}}else console.log("no locfile");var r=Alloy.createController("caplocdata");r.openMainWindow(i.tab_settings)}),_.extend(i,o)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;