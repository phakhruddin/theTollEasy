function Controller(){require("alloy/controllers/BaseController").apply(this,Array.prototype.slice.call(arguments)),this.__controllerPath="index",arguments[0]?arguments[0].__parentSymbol:null,arguments[0]?arguments[0].$model:null,arguments[0]?arguments[0].__itemTemplate:null;var e=this,t={};Alloy.Collections.instance("found");var o=[];e.__views.__alloyId47=Alloy.createController("tabViewOne",{apiName:"Alloy.Require",id:"__alloyId47",classes:[]}),o.push(e.__views.__alloyId47.getViewEx({recurse:!0})),e.__views.__alloyId48=Alloy.createController("tabViewTwo",{apiName:"Alloy.Require",id:"__alloyId48",classes:[]}),o.push(e.__views.__alloyId48.getViewEx({recurse:!0})),e.__views.index=Ti.UI.createTabGroup({tabs:o,apiName:"Ti.UI.TabGroup",id:"index",classes:[]}),e.__views.index&&e.addTopLevelView(e.__views.index),t.destroy=function(){},_.extend(e,e.__views),e.index.open();var a=!1;Titanium.App.Properties.setInt("complextracking",0);var l=!1;Titanium.App.Properties.setInt("simpletracking",0),Titanium.App.Properties.setInt("count",0),Titanium.App.Properties.setInt("maildebug",0),loc=Titanium.App.Properties.getString("loc")?Titanium.App.Properties.getString("loc"):"newberlin";var n="maildebug.txt",r="location.txt",s=loc+".txt",d=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,s),c=loc+"1.txt",u=Ti.Filesystem.getFile(Ti.Filesystem.tempDirectory,c),p=d.read()||u.read(),m=p.text,h=h||JSON.parse(m),g="json data : "+JSON.stringify(h);1==Titanium.App.Properties.getInt("maildebug")&&Alloy.Globals.appendFile(g,n),lat1=time1=timelastdebug=0;var f=function(e){if(a){var t=+e.coords.longitude,o=+e.coords.latitude,l=+e.coords.timestamp,s=new Date(l)+","+l+","+o+","+t,d=Titanium.App.Properties.getInt("count",d);if(d++,console.log(s),1==Titanium.App.Properties.getInt("maildebug")&&d>=30){console.log(s+" should be appended to maildebug.txt"),Alloy.Globals.appendFile(s,r);var d=0}for(Titanium.App.Properties.setInt("count",d),Titanium.Geolocation.reverseGeocoder(o,t,function(e){if(e.success){var t=e.places;currentaddr=t&&t.length?t[0].address:"No address found",Titanium.App.Properties.setString("currentaddr",currentaddr),Ti.API.debug("reverse geolocation result = "+JSON.stringify(e))}}),i=0;h.poi.length>i;i++){var c=h.poi[i].plaza,u=h.poi[i].latitude,p=h.poi[i].longitude,_=Alloy.Globals.calcDistance(o,t,u,p,"F");y.push({tolltollplaza:c,dist:_,latitude:u,longitude:p,hwy:U,cost:x,type:P,note:C})}var m=y.sort(function(e,t){return e.dist-t.dist});m[0].tolltollplaza;var g=m[0].tolltollplaza;m[0].dist,m[1].tolltollplaza,m[1].dist,m[2].tolltollplaza,m[2].dist;var f=m[0].tolltollplaza+" distance : "+m[0].dist;Titanium.App.Properties.setString("outputclosesttollbydist0",f);var T=100,w=Titanium.App.Properties.getString("timelastupd")||0,v=Titanium.App.Properties.getString("tolllastupd")||"None",w=parseFloat(w),b=l-w,I=1e4;if(T>m[0].dist&&b>I&&g!=v){var A=m[0].tolltollplaza,S=m[0].longitude,E=m[0].latitude,N=l,x=m[0].cost,P=m[0].type,U=m[0].hwy,C=m[0].note;Alloy.Globals.updateFound(A,S,E,N,x,P,U),Titanium.App.Properties.setString("timelastupd",N),Titanium.App.Properties.setString("tolllastupd",A),Ti.App.iOS.scheduleLocalNotification({alertBody:new Date+" : tollplaza "+A+" was detected less than "+m[0].dist+" ft away",date:new Date((new Date).getTime()+1e3)});var s=new Date+" : tollplaza "+A+" was detected less than "+m[0].dist+" ft away";1==Titanium.App.Properties.getInt("maildebug")&&Alloy.Globals.appendFile(s,n)}else if(1==Titanium.App.Properties.getInt("maildebug")){var L=new Date,s=L+":"+g+":x:"+v;s+="|range<"+T+"?:"+m[0].dist,s+="|timediff<"+I+"?:"+b,console.log(s),Alloy.Globals.appendFile(s,n)}}},T=function(e){if(a){if(e.error)return void(updatedHeading="error: "+e.error);var t=e.heading.x,i=e.heading.y,o=e.heading.z;e.heading.magneticHeading,e.heading.accuracy;var l=e.heading.trueHeading,n=e.heading.timestamp;currentHeading="x:"+t+" y: "+i+" z:"+o,Titanium.API.info("geo - current heading: "+new Date(n)+" x "+t+" y "+i+" z "+o),Titanium.App.Properties.setString("currentHeading",l)}};if(Ti.Geolocation.locationServicesEnabled){var y=closestdist=[];if(Titanium.Geolocation.accuracy=Titanium.Geolocation.ACCURACY_BEST,Titanium.Geolocation.distanceFilter=5,Titanium.Geolocation.purpose="Get Current Location",Titanium.Geolocation.addEventListener("location",f),locationAdded=!0&&Titanium.App.Properties.setString("locationAdded","true"),Titanium.Geolocation.hasCompass)Titanium.Geolocation.showCalibration=!1,Titanium.Geolocation.headingFilter=5,Titanium.Geolocation.addEventListener("heading",T),headingAdded=!0;else{Titanium.API.info("No Compass on device"),currentHeading="No compass available";var w="No compass available";Titanium.App.Properties.setString("currentHeading",w)}}else alert("Please enable location services");var v=function(e){var t=Titanium.App.Properties.getInt("count");if(l){var t=Titanium.App.Properties.getInt("count",t);if(t++,g=new Date(e.coords.timestamp)+","+e.coords.timestamp+","+e.coords.latitude+","+e.coords.longitude,1==Titanium.App.Properties.getInt("maildebug")&&t>=30){console.log(g+" should be appended to maildebug.txt"),Alloy.Globals.appendFile(g,r);var t=0}Ti.API.info("Location: "+e.coords.latitude+" , "+e.coords.longitude+" , "+new Date(e.coords.timestamp)),Titanium.App.Properties.setInt("count",t)}};Ti.Geolocation.addEventListener("location",v),Ti.App.addEventListener("pause",function(){1==Titanium.App.Properties.getInt("complextracking")&&(a=!0,console.log("transition to background with complextracking and debug set to :"+Titanium.App.Properties.getInt("maildebug"))),1==Titanium.App.Properties.getInt("simpletracking")&&(l=!0,console.log("transition to background with simpletracking and debug set to :"+Titanium.App.Properties.getInt("maildebug")))}),Ti.App.addEventListener("resume",function(){a=!1,Titanium.App.Properties.setInt("complextracking",0),l=!1,Titanium.App.Properties.setInt("simpletracking",0)}),_.extend(e,t)}var Alloy=require("alloy"),Backbone=Alloy.Backbone,_=Alloy._;module.exports=Controller;